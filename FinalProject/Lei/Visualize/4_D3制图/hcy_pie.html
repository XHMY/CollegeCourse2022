<html>
<head>
    <meta charSet="UTF-8">
    <title>Pie</title>
    <center><font size="8"><strong>2021-2022学年第1学期成绩信息情况（饼图）</strong></font></center>
    <title>Pie</title>
</head>
<body>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script>
    var w = window.innerWidth
        || document.documentElement.clientWidth
        || document.body.clientWidth;

    var h = window.innerHeight
        || document.documentElement.clientHeight
        || document.body.clientHeight;
    w = w * 0.98;
    h = h * 0.9;
    var svg = d3.select("body")
        .append("svg")
        .attr("width", w)
        .attr("height", h);

    var dataset = [["Flash动画技术入门", 99], ["石文化与宝玉石鉴赏", 98] ,["形势与政策Ⅴ", 96], ["篮球", 95], ["云计算与大数据", 93],  ["Java EE应用开发技术", 92],["数据仓库理论与实践", 91],["创业基础与实践Ⅱ", 90], ["Java海量数据分布式开发", 90], ["大数据推荐系统实践", 90], ["形势与政策Ⅱ", 89], ["大学生发展规划与就业指导Ⅲ", 88], ["计算机网络", 87]];
    var pie = d3.layout.pie()
        .value(function (d) {
            return d[1];
        });
    var piedata = pie(dataset);
    var color = ['#ff7f7f','#ff7fbf','#ff7fff','#bf7fff','#7f7fff','#7fbfff','#7fffff','#7fffbf','#7fff7f','#bfff7f','#ffff7f','#ffbf7f','#ffd3a8'];
    var arc = d3.svg.arc()
        .innerRadius(100)
        .outerRadius(200)

    var arc2 = d3.svg.arc()
        .innerRadius(120)
        .outerRadius(220)

    var arcs = svg.selectAll("g")
        .data(piedata)
        .enter()
        .append("g")
        .attr("transform", "translate(" + (w / 2) + "," + (h / 2) + ")");
    arcs.append("path")
        .attr("d", function (d,i) {
            return i != 0 ? arc(d) : arc2(d);
        })
        .attr("fill", function (d,i) {
            return i != 0 ? color[i] : "#ff7f7f";
        })
        // .attr("fill", "#7bbfea")
        .attr("stroke", "white")
        .on("mouseover", function (d) {
            d3.select(this)
                .attr("fill", "#f8aba6")
        })
        .on("mouseout", function (d,i) {
            return i!=0 ? d3.select(this).attr("fill", color[i]) : d3.select(this).attr("fill", "#ff7f7f")

        })
        ;
    svg.selectAll("text")
        .data(piedata)
        .enter()
        .append("text")
        .attr("fill", "white")
        .attr("text-anchor", "middle")
        .attr("transform", function (d) {
            var x = arc.centroid(d)[0];
            var y = arc.centroid(d)[1];
            return "translate(" + (w / 2 + x) + "," + (h / 2 + y) + ")";
        })
        .text(function (d) {
            return d.value
        });
    arcs.append("line")
        .attr("stroke", "#cde6c7")
        .attr("x1", function (d) {
            return arc.centroid(d)[0] * 1.5;
        })
        .attr("y1", function (d) {
            return arc.centroid(d)[1] * 1.34;
        })
        .attr("x2", function (d) {
            return arc.centroid(d)[0] * 1.7;
        })
        .attr("y2", function (d) {
            return arc.centroid(d)[1] * 1.5;
        });

    arcs.append("text")
        .attr("fill", "#145b7d")
        .attr("transform", function (d) {
            var x = arc.centroid(d)[0] * 2.2;
            var y = arc.centroid(d)[1] * 1.7;
            return "translate(" + x + "," + y + ")";
        })
        .attr("text-anchor", "middle")
        .text(function (d) {
            return d.data[0];
        });

</script>

</body>
</html>
